from flask import Flask, request, jsonify
import joblib
import numpy as np

app = Flask(__name__)

# Load model and scaler
model = joblib.load("model.pkl")
scaler = joblib.load("scaler.pkl")
# Add a default route
@app.route('/')
def home():
    return "Welcome to the Malware Detection API! Use the /predict endpoint for predictions."

# Example list of training feature columns
training_features = ['feature1', 'feature2', ..., 'feature1000']  # Replace with your training feature names

@app.route('/predict', methods=['POST'])
def predict():
    try:
        data = request.json['features']
        if len(data) != len(training_features):  # Check for feature mismatch
            return jsonify({'error': f'Expected {len(training_features)} features, but got {len(data)}'}), 400

        # Transform the data
        scaled_data = scaler.transform([data])
        prediction = model.predict(scaled_data)
        return jsonify({'prediction': int(prediction[0])})
    except Exception as e:
        return jsonify({'error': str(e)}), 500


if __name__ == "__main__":
    app.run(port=5000)
