# **Dynamic Malware Behavior Logging System**

## **📌 Overview**
The **Dynamic Malware Behavior Logging System** is a comprehensive framework for tracking and analyzing malware activities on a system. This tool monitors **filesystem changes, registry modifications, and network activity**, while also providing **machine learning-based classification** and **VirusTotal integration** for enhanced malware detection.

---

## **🛠 Features**
✅ **Real-time File System Monitoring** – Detects suspicious file operations  
✅ **Windows Registry Monitoring** – Logs malware persistence attempts  
✅ **Network Traffic Analysis** – Captures potential C2 communications  
✅ **PE Header & Import Analysis** – Extracts executable details  
✅ **Machine Learning Classification** – Detects malware based on behavior patterns  
✅ **Entropy Analysis** – Identifies packed or encrypted executables  
✅ **VirusTotal Hash Lookup** – Flags known malicious files  
✅ **Comprehensive Logging & Reporting** – Generates reports in JSON, CSV, and HTML formats  

---

## **📂 Project Structure**
```
dynamic_malware_behavior_logging/
│
├── dataset/                     # (For training data - JSON files with API call logs)
│   ├── sample1.json
│   ├── sample2.json
│
├── models/                      # (Trained machine learning models)
│   ├── malware_classifier.pkl
│   ├── vectorizer.pkl
│
├── reports/                     # (Generated scan reports)
│
├── src/                         # (Main source code)
│   ├── __init__.py
│   ├── scanner.py               # Scans files for malware indicators
│   ├── registry_monitor.py       # Monitors Windows registry changes
│   ├── filesystem_monitor.py     # Tracks filesystem modifications
│   ├── network_monitor.py        # Captures network activity
│   ├── logger.py                 # Logs events and alerts
│   ├── report_generator.py       # Creates reports in JSON, CSV, and HTML
│   ├── run_monitor.py            # Runs all monitoring modules in parallel
│
├── train_malware_classifier.py   # (Script to train the ML model)
│
├── requirements.txt              # (Project dependencies)
├── .gitignore                    # (Ignored files in Git)
├── README.md                     # (This file)
└── .env                          # (Environment variables for API keys)
```

---

## **🚀 Installation**
### **1️⃣ Clone the Repository**
```bash
git clone https://github.com/Roh00t/PersonalProjects/REM_Projects/dynamic_malware_behavior_logging.git
cd dynamic_malware_behavior_logging
```

### **2️⃣ Install Dependencies**
```bash
pip install -r requirements.txt
```

### **3️⃣ Configure Environment Variables**
Create a **`.env`** file in the root directory and add:
```
VIRUSTOTAL_API_KEY=your_api_key_here
```

---

## **🖥️ Usage**
### **🔹 Run Full Monitoring System**
```bash
python src/run_monitor.py
```

### **🔹 Scan a Specific File**
```bash
python src/scanner.py --file path/to/file.exe
```

### **🔹 Train Machine Learning Model**
```bash
python train_malware_classifier.py
```

### **🔹 View Generated Reports**
Reports are saved in the **`reports/`** directory. You can open them in any text editor or a web browser.

---

## **🧪 Example Report Output**
```json
{
    "file": "malware.exe",
    "sha256": "b1946ac92492d2347c6235b4d2611184",
    "suspicious_functions": ["CreateRemoteThread", "WriteProcessMemory"],
    "entropy_analysis": {"text_section": 7.8, "data_section": 2.3},
    "virustotal": {"malicious_votes": 15, "total_votes": 65},
    "ml_prediction": "Malicious"
}
```

---

## **🛡️ Security Considerations**
⚠ **DO NOT** run this tool on your main system without proper isolation (use a **virtual machine or sandbox**).  
⚠ **Ensure legal compliance** before scanning files from external sources.  
⚠ **Use responsible disclosure** if findings indicate real-world threats.  

---

## **📜 License**
This project is licensed under the **MIT License**.

---

## **🤝 Contributing**
1. Fork the repository  
2. Create a new branch (`git checkout -b feature-branch`)  
3. Commit your changes (`git commit -m "Added new feature"`)  
4. Push to your branch (`git push origin feature-branch`)  
5. Open a Pull Request  

---

## **📩 Contact**
For inquiries or contributions, create an issue on GitHub.

---