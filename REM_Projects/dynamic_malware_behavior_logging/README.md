# **Dynamic Malware Behavior Logging System**

## **ğŸ“Œ Overview**
The **Dynamic Malware Behavior Logging System** is a comprehensive framework for tracking and analyzing malware activities on a system. This tool monitors **filesystem changes, registry modifications, and network activity**, while also providing **machine learning-based classification** and **VirusTotal integration** for enhanced malware detection.

---

## **ğŸ›  Features**
âœ… **Real-time File System Monitoring** â€“ Detects suspicious file operations  
âœ… **Windows Registry Monitoring** â€“ Logs malware persistence attempts  
âœ… **Network Traffic Analysis** â€“ Captures potential C2 communications  
âœ… **PE Header & Import Analysis** â€“ Extracts executable details  
âœ… **Machine Learning Classification** â€“ Detects malware based on behavior patterns  
âœ… **Entropy Analysis** â€“ Identifies packed or encrypted executables  
âœ… **VirusTotal Hash Lookup** â€“ Flags known malicious files  
âœ… **Comprehensive Logging & Reporting** â€“ Generates reports in JSON, CSV, and HTML formats  

---

## **ğŸ“‚ Project Structure**
```
dynamic_malware_behavior_logging/
â”‚
â”œâ”€â”€ dataset/                     # (For training data - JSON files with API call logs)
â”‚   â”œâ”€â”€ sample1.json
â”‚   â”œâ”€â”€ sample2.json
â”‚
â”œâ”€â”€ models/                      # (Trained machine learning models)
â”‚   â”œâ”€â”€ malware_classifier.pkl
â”‚   â”œâ”€â”€ vectorizer.pkl
â”‚
â”œâ”€â”€ reports/                     # (Generated scan reports)
â”‚
â”œâ”€â”€ src/                         # (Main source code)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ scanner.py               # Scans files for malware indicators
â”‚   â”œâ”€â”€ registry_monitor.py       # Monitors Windows registry changes
â”‚   â”œâ”€â”€ filesystem_monitor.py     # Tracks filesystem modifications
â”‚   â”œâ”€â”€ network_monitor.py        # Captures network activity
â”‚   â”œâ”€â”€ logger.py                 # Logs events and alerts
â”‚   â”œâ”€â”€ report_generator.py       # Creates reports in JSON, CSV, and HTML
â”‚   â”œâ”€â”€ run_monitor.py            # Runs all monitoring modules in parallel
â”‚
â”œâ”€â”€ train_malware_classifier.py   # (Script to train the ML model)
â”‚
â”œâ”€â”€ requirements.txt              # (Project dependencies)
â”œâ”€â”€ .gitignore                    # (Ignored files in Git)
â”œâ”€â”€ README.md                     # (This file)
â””â”€â”€ .env                          # (Environment variables for API keys)
```

---

## **ğŸš€ Installation**
### **1ï¸âƒ£ Clone the Repository**
```bash
git clone https://github.com/Roh00t/PersonalProjects/REM_Projects/dynamic_malware_behavior_logging.git
cd dynamic_malware_behavior_logging
```

### **2ï¸âƒ£ Install Dependencies**
```bash
pip install -r requirements.txt
```

### **3ï¸âƒ£ Configure Environment Variables**
Create a **`.env`** file in the root directory and add:
```
VIRUSTOTAL_API_KEY=your_api_key_here
```

---

## **ğŸ–¥ï¸ Usage**
### **ğŸ”¹ Run Full Monitoring System**
```bash
python src/run_monitor.py
```

### **ğŸ”¹ Scan a Specific File**
```bash
python src/scanner.py --file path/to/file.exe
```

### **ğŸ”¹ Train Machine Learning Model**
```bash
python train_malware_classifier.py
```

### **ğŸ”¹ View Generated Reports**
Reports are saved in the **`reports/`** directory. You can open them in any text editor or a web browser.

---

## **ğŸ§ª Example Report Output**
```json
{
    "file": "malware.exe",
    "sha256": "b1946ac92492d2347c6235b4d2611184",
    "suspicious_functions": ["CreateRemoteThread", "WriteProcessMemory"],
    "entropy_analysis": {"text_section": 7.8, "data_section": 2.3},
    "virustotal": {"malicious_votes": 15, "total_votes": 65},
    "ml_prediction": "Malicious"
}
```

---

## **ğŸ›¡ï¸ Security Considerations**
âš  **DO NOT** run this tool on your main system without proper isolation (use a **virtual machine or sandbox**).  
âš  **Ensure legal compliance** before scanning files from external sources.  
âš  **Use responsible disclosure** if findings indicate real-world threats.  

---

## **ğŸ“œ License**
This project is licensed under the **MIT License**.

---

## **ğŸ¤ Contributing**
1. Fork the repository  
2. Create a new branch (`git checkout -b feature-branch`)  
3. Commit your changes (`git commit -m "Added new feature"`)  
4. Push to your branch (`git push origin feature-branch`)  
5. Open a Pull Request  

---

## **ğŸ“© Contact**
For inquiries or contributions, create an issue on GitHub.

---